# Дополнительный сгенерированный материал

# Слепая подпись Чаума и ее использование в протоколе «Электронное голосование». Протокол «Игра в покер по переписке» (Ментальный покер)

---

## Введение

В современной криптографии слепые подписи и протоколы распределения секретов играют ключевую роль в обеспечении приватности, анонимности и честности в распределённых системах. Среди классических и фундаментальных конструкций — слепая подпись Чаума (Chaum’s Blind Signature) и протоколы ментального покера, которые позволяют моделировать честную игру по переписке без доверенного третьего лица.

Данное пособие подробно раскрывает:

- математическую основу слепой подписи Чаума,
- её применение в протоколах электронного голосования,
- и далее — протоколы ментального покера, которые используют похожие криптографические идеи для обеспечения честной игры.

---

# Часть 1. Слепая подпись Чаума

---

## 1.1 Определение и контекст

**Слепая подпись** — это криптографический протокол, позволяющий одному участнику (подписывающему) подписать сообщение, не узнавая его содержания. При этом подписываемое сообщение остаётся «слепым» для подписывающего, но подпись остаётся валидной и проверяемой для третьих лиц.

Это важный инструмент для обеспечения анонимности в системах, где требуется доказательство авторства или права, но при этом необходимо скрыть содержание подписываемого сообщения.

---

## 1.2 Математическая основа слепой подписи Чаума

Слепая подпись Чаума базируется на асимметричной криптосистеме RSA. Предположим, что у подписывающего есть открытый ключ $(N, e)$ и закрытый ключ $d$, где:

- $N = pq$ — произведение двух больших простых чисел,
- $e$ — открытая экспонента,
- $d$ — закрытая экспонента, удовлетворяющая условию $ed \equiv 1 \pmod{\varphi(N)}$,
- $\varphi(N) = (p-1)(q-1)$ — функция Эйлера.

---

### 1.2.1 Стандартная цифровая подпись RSA

Для сообщения $m$ (число, $0 < m < N$) подпись создаётся как:

$$
s = m^d \bmod N
$$

Проверка подписи:

$$
s^e \equiv m \pmod{N}
$$

---

### 1.2.2 Идея слепой подписи

Пусть пользователь хочет получить подпись на сообщение $m$, не раскрывая его подписывающему.

Для этого он выбирает случайное число $r$, взаимно простое с $N$ (то есть $\gcd(r, N) = 1$), и вычисляет «слепое» сообщение:

$$
m' = m \cdot r^e \bmod N
$$

Пользователь отправляет $m'$ подписывающему.

Подписывающий вычисляет подпись на $m'$:

$$
s' = (m')^d \bmod N
$$

Подписывающий возвращает $s'$ пользователю.

Пользователь «открывает» подпись, вычисляя:

$$
s = s' \cdot r^{-1} \bmod N
$$

где $r^{-1}$ — мультипликативный обратный к $r$ по модулю $N$.

---

### 1.2.3 Доказательство корректности

Раскроем $s$:

$$
s = s' \cdot r^{-1} = (m')^d \cdot r^{-1} = (m \cdot r^e)^d \cdot r^{-1} = m^d \cdot (r^e)^d \cdot r^{-1} = m^d \cdot r^{ed} \cdot r^{-1} \pmod{N}
$$

Поскольку $ed \equiv 1 \pmod{\varphi(N)}$, то:

$$
r^{ed} \equiv r^{1 + k \varphi(N)} \equiv r \cdot (r^{\varphi(N)})^k \equiv r \cdot 1^k \equiv r \pmod{N}
$$

(по малой теореме Эйлера $r^{\varphi(N)} \equiv 1 \pmod{N}$).

Следовательно,

$$
s = m^d \cdot r \cdot r^{-1} = m^d \pmod{N}
$$

То есть $s$ — это корректная подпись на исходное сообщение $m$.

---

### 1.2.4 Объяснение символов и шагов

- $m$ — исходное сообщение, которое пользователь хочет подписать.
- $r$ — случайное число, выбранное пользователем для «слепления» сообщения.
- $N, e, d$ — параметры RSA.
- $m' = m \cdot r^e \bmod N$ — «слепое» сообщение, которое подписывающий видит и подписывает.
- $s' = (m')^d \bmod N$ — подпись на слепое сообщение.
- $s = s' \cdot r^{-1} \bmod N$ — «открытая» подпись, валидная для $m$.

---

## 1.3 Практическое использование слепой подписи Чаума

- **Электронные деньги**: пользователь получает подпись банка на «слепой» токен, который потом можно использовать анонимно.
- **Электронное голосование**: голосование с анонимностью — избиратель получает подпись на свой голос, не раскрывая его содержимое.
- **Протоколы анонимной аутентификации**.

---

# Часть 2. Использование слепой подписи Чаума в протоколе «Электронное голосование»

---

## 2.1 Цели протокола электронного голосования

- Обеспечить **анонимность** избирателя.
- Гарантировать **целостность** и **подлинность** голосов.
- Исключить возможность **фальсификации** и **двойного голосования**.
- Обеспечить **проверяемость** результатов.

---

## 2.2 Общая схема протокола с использованием слепой подписи

1. Избиратель формирует свой голос $v$ (например, за кандидата №1 или №2).
2. Избиратель «слепит» голос с помощью случайного числа $r$ и открытого ключа избирательной комиссии (ИК):

   $$
   v' = v \cdot r^e \bmod N
   $$

3. Избиратель отправляет $v'$ в ИК.
4. ИК подписывает $v'$ своим закрытым ключом:

   $$
   s' = (v')^d \bmod N
   $$

5. ИК возвращает $s'$ избирателю.
6. Избиратель «открывает» подпись:

   $$
   s = s' \cdot r^{-1} \bmod N
   $$

7. Избиратель отправляет пару $(v, s)$ в систему голосования.
8. Система проверяет подпись $s$ на $v$ с помощью открытого ключа ИК:

   $$
   s^e \stackrel{?}{=} v \pmod{N}
   $$

9. Если проверка успешна, голос засчитывается.

---

## 2.3 Обеспечение анонимности и предотвращение двойного голосования

- Поскольку ИК подписывает **слепое** сообщение $v'$, она не знает, какой именно голос подписывает.
- Подпись $s$ можно проверить, но невозможно связать с конкретным избирателем, так как $r$ скрывает связь между $v$ и $v'$.
- Для предотвращения двойного голосования используется механизм регистрации и контроля выдачи слепых сообщений — ИК выдает подписи только на один слепой голос на избирателя.

---

## 2.4 Подробный пример

Пусть:

- $N = 2537$ (произведение простых $43 \times 59$),
- $e = 13$,
- $d = 937$ (обратное к $e$ по $\varphi(N) = (43-1)(59-1) = 42 \times 58 = 2436$),
- голос $v = 42$,
- случайное $r = 7$.

---

### Шаг 1: Вычисляем слепое сообщение

$$
v' = v \cdot r^e \bmod N = 42 \cdot 7^{13} \bmod 2537
$$

Вычислим $7^{13} \bmod 2537$ (используя быстрое возведение в степень):

- $7^1 = 7$
- $7^2 = 49$
- $7^4 = (7^2)^2 = 49^2 = 2401 \bmod 2537 = 2401$
- $7^8 = (7^4)^2 = 2401^2 \bmod 2537$

Вычислим $2401^2 \bmod 2537$:

$2401^2 = 2401 \times 2401 = 5,764,801$

$5,764,801 \bmod 2537$:

- $2537 \times 2273 = 5,764,601$ (приблизительно)
- Остаток: $5,764,801 - 5,764,601 = 200$

Значит, $7^8 \equiv 200 \bmod 2537$.

Теперь $7^{13} = 7^{8} \times 7^{4} \times 7^{1} = 200 \times 2401 \times 7 \bmod 2537$.

Вычислим по шагам:

- $200 \times 2401 = 480,200 \bmod 2537$

Вычислим $480,200 \bmod 2537$:

- $2537 \times 189 = 479,493$
- Остаток: $480,200 - 479,493 = 707$

Итого, $200 \times 2401 \equiv 707 \bmod 2537$.

Теперь умножаем на 7:

- $707 \times 7 = 4,949 \bmod 2537$

Вычислим $4,949 \bmod 2537$:

- $2537 \times 1 = 2537$
- Остаток: $4,949 - 2,537 = 2,412$

Итого:

$$
7^{13} \equiv 2,412 \pmod{2537}
$$

Теперь вычислим $v' = 42 \times 2,412 \bmod 2537$:

- $42 \times 2,412 = 101,304$

Вычислим $101,304 \bmod 2537$:

- $2537 \times 39 = 99,943$
- Остаток: $101,304 - 99,943 = 1,361$

Итого:

$$
v' = 1,361
$$

---

### Шаг 2: Подписывающий вычисляет подпись на $v'$:

$$
s' = (v')^d \bmod N = 1,361^{937} \bmod 2537
$$

Это вычисление громоздкое, но в реальных системах используется быстрое возведение в степень по модулю.

---

### Шаг 3: Избиратель вычисляет обратное к $r = 7$ по модулю $N = 2537$

Найдем $r^{-1}$, такое что:

$$
7 \cdot r^{-1} \equiv 1 \pmod{2537}
$$

Используем расширенный алгоритм Евклида:

- $2537 = 7 \times 362 + 3$
- $7 = 3 \times 2 + 1$
- $3 = 1 \times 3 + 0$

Обратно:

- $1 = 7 - 3 \times 2$
- $3 = 2537 - 7 \times 362$

Подставляем:

$$
1 = 7 - (2537 - 7 \times 362) \times 2 = 7 \times (1 + 2 \times 362) - 2537 \times 2 = 7 \times 725 - 2537 \times 2
$$

Значит,

$$
r^{-1} \equiv 725 \pmod{2537}
$$

---

### Шаг 4: Избиратель вычисляет окончательную подпись:

$$
s = s' \cdot 725 \bmod 2537
$$

---

### Шаг 5: Проверка подписи

Проверка:

$$
s^e \equiv v \pmod{N}
$$

---

## 2.5 Итог

Таким образом, избиратель получил подпись на свой голос, не раскрывая его содержимое подписывающему. Это обеспечивает анонимность и подлинность голосов.

---

# Часть 3. Протокол «Игра в покер по переписке» (Ментальный покер)

---

## 3.1 Постановка задачи

**Ментальный покер** — это протокол, позволяющий двум или более игрокам играть в покер по переписке (или через ненадёжный канал), без доверенного третьего лица, при этом:

- Карты должны быть случайно перемешаны и распределены,
- Никто не должен знать карты других игроков,
- Нельзя подделать или изменить карты,
- Все должны быть уверены в честности игры.

---

## 3.2 Основные криптографические задачи

- **Обеспечение случайности и непредсказуемости** колоды.
- **Шифрование карт** так, чтобы только владелец мог их открыть.
- **Совместное перемешивание** колоды без доверия к другим игрокам.
- **Доказательство честности** без раскрытия карт.

---

## 3.3 Классический протокол ментального покера (на основе RSA)

---

### 3.3.1 Идея протокола

- Каждая карта представляется уникальным числом $m_i$ из некоторого множества.
- Все карты шифруются с помощью публичных ключей игроков.
- Игроки последовательно применяют свои шифры и перемешивают колоду.
- В конце каждый игрок расшифровывает только свои карты.

---

### 3.3.2 Математическая модель

Пусть два игрока: $A$ и $B$.

- Игрок $A$ генерирует пару ключей RSA: $(N_A, e_A)$ и $(N_A, d_A)$.
- Игрок $B$ генерирует пару ключей RSA: $(N_B, e_B)$ и $(N_B, d_B)$.
- Колода карт — множество чисел $M = \{m_1, m_2, ..., m_n\}$.

---

### 3.3.3 Шаги протокола

1. Игрок $A$ шифрует каждую карту $m_i$ своим открытым ключом:

   $$
   c_i = m_i^{e_A} \bmod N_A
   $$

2. Игрок $A$ перемешивает зашифрованные карты $\{c_i\}$ случайным образом и отправляет их игроку $B$.

3. Игрок $B$ шифрует каждую карту своим открытым ключом:

   $$
   c_i' = c_i^{e_B} \bmod N_B
   $$

4. Игрок $B$ перемешивает полученный набор $\{c_i'\}$ и отправляет обратно игроку $A$.

5. Игрок $A$ расшифровывает каждую карту своим закрытым ключом:

   $$
   c_i'' = (c_i')^{d_A} \bmod N_A = (m_i^{e_A e_B})^{d_A} = m_i^{e_B} \bmod N_A
   $$

6. Игрок $A$ отправляет обратно $\{c_i''\}$ игроку $B$.

7. Игрок $B$ расшифровывает каждую карту своим закрытым ключом:

   $$
   m_i = (c_i'')^{d_B} \bmod N_B = m_i^{e_B d_B} = m_i \bmod N_B
   $$

---

### 3.3.4 Распределение карт

- После совместного перемешивания и двойного шифрования каждый игрок выбирает карты, расшифровывая их только своим ключом.
- Поскольку карты были перемешаны и зашифрованы обоими игроками, никто не может узнать карты другого.

---

## 3.4 Связь с слепой подписью и анонимностью

- Слепая подпись обеспечивает, что подпись (или шифрование) может быть применена без раскрытия содержимого.
- В ментальном покере аналогично, шифрование и перемешивание обеспечивают «слепость» карт для других игроков.
- Оба протокола используют свойства RSA и обратимости операций по модулю.

---

## 3.5 Пример интуиции

Представьте, что у вас есть колода карт, которую вы сначала покрываете непрозрачной плёнкой (шифруете своим ключом), перемешиваете и отдаёте другу. Друг накладывает свою плёнку (шифрует своим ключом) и перемешивает. Затем вы снимаете свою плёнку (расшифровываете), оставляя плёнку друга, и возвращаете колоду. Друг снимает свою плёнку и получает карты в случайном порядке, не зная, как вы их перемешали.

---

# Заключение

---

## Итоги

- **Слепая подпись Чаума** — фундаментальный криптографический инструмент, позволяющий подписывать сообщения, не раскрывая их содержимого, основанный на RSA.
- В **электронном голосовании** слепая подпись обеспечивает анонимность и подлинность голосов, предотвращая связь между избирателем и его голосом.
- **Протокол ментального покера** использует идеи шифрования и совместного перемешивания карт с помощью RSA, обеспечивая честность и приватность игры без доверенного третьего лица.
- Оба протокола демонстрируют глубокую связь между теорией чисел, асимметричной криптографией и практическими задачами обеспечения приватности и честности в распределённых системах.

---

## Рекомендуемая литература для углубления

- D. Chaum, "Blind Signatures for Untraceable Payments," Advances in Cryptology — CRYPTO ’82.
- M. Blum, "Mental Poker," Proceedings of the 14th Annual IEEE Symposium on Foundations of Computer Science, 1973.
- A. Menezes, P. van Oorschot, S. Vanstone, "Handbook of Applied Cryptography," CRC Press, 1996.
- J. Katz, Y. Lindell, "Introduction to Modern Cryptography," 2nd Edition, CRC Press, 2014.

---

Если у вас остались вопросы по деталям реализации, математическим доказательствам или практическим аспектам — готов подробно разобрать!