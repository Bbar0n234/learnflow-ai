# Финальный синтезированный материал

# Слепая подпись Чаума и ее использование в протоколе «Электронное голосование». Протокол «Игра в покер по переписке» (Ментальный покер)

---

## Введение

В данной теме рассматриваются два важных криптографических протокола, основанных на асимметричной криптографии (RSA):

- **Слепая подпись Чаума** — механизм, позволяющий получить цифровую подпись на сообщение, не раскрывая его содержимого подписывающему.
- **Протокол электронного голосования**, использующий слепую подпись для обеспечения анонимности и подлинности голосов.
- **Протокол «Игра в покер по переписке» (ментальный покер)** — способ честной игры в покер между удалёнными игроками без доверенного посредника, основанный на совместном шифровании и обмене ключами.

---

# Часть 1. Слепая подпись Чаума

---

## 1.1 Основные понятия и обозначения

- Криптосистема RSA задаётся параметрами:
  - \( N = pq \) — модуль, произведение двух больших простых чисел \( p \) и \( q \).
  - \( e \) — открытая экспонента.
  - \( d \) — закрытая экспонента, такая что \( ed \equiv 1 \pmod{\varphi(N)} \), где \(\varphi(N) = (p-1)(q-1)\).
- Сообщение \( m \), где \( 0 < m < N \).
- Случайное число \( r \), взаимно простое с \( N \) (то есть \(\gcd(r, N) = 1\)).

---

## 1.2 Стандартная цифровая подпись RSA

- Подпись на сообщение \( m \) создаётся как:

  $$
  s = m^d \bmod N
  $$

- Проверка подписи:

  $$
  s^e \equiv m \pmod{N}
  $$

---

## 1.3 Идея слепой подписи Чаума

Пользователь хочет получить подпись на сообщение \( m \), не раскрывая его подписывающему.

### Шаги протокола:

1. Пользователь выбирает случайное число \( r \), взаимно простое с \( N \).
2. Вычисляет «слепое» сообщение:

   $$
   m' = m \cdot r^e \bmod N
   $$

3. Отправляет \( m' \) подписывающему.
4. Подписывающий вычисляет подпись на \( m' \):

   $$
   s' = (m')^d \bmod N
   $$

5. Возвращает \( s' \) пользователю.
6. Пользователь «открывает» подпись:

   $$
   s = s' \cdot r^{-1} \bmod N
   $$

   где \( r^{-1} \) — мультипликативный обратный к \( r \) по модулю \( N \).

---

## 1.4 Доказательство корректности

Раскроем выражение для \( s \):

$$
\begin{aligned}
s &= s' \cdot r^{-1} = (m')^d \cdot r^{-1} = (m \cdot r^e)^d \cdot r^{-1} = m^d \cdot (r^e)^d \cdot r^{-1} \pmod{N} \\
&= m^d \cdot r^{ed} \cdot r^{-1} \pmod{N}
\end{aligned}
$$

Поскольку \( ed \equiv 1 \pmod{\varphi(N)} \), то по малой теореме Эйлера:

$$
r^{ed} \equiv r^{1 + k \varphi(N)} \equiv r \cdot (r^{\varphi(N)})^k \equiv r \cdot 1^k \equiv r \pmod{N}
$$

Следовательно,

$$
s = m^d \cdot r \cdot r^{-1} = m^d \pmod{N}
$$

То есть \( s \) — корректная подпись на исходное сообщение \( m \).

---

## 1.5 Ключевые обозначения из конспекта

- \( K \) — ключ.
- \( h, r \) — параметры (в частности, \( r \) — случайное число для слепой подписи).
- \( l \) — длина или номер ключа.
- \( n_i \) — участники.
- \( PK_i, SK_i \) — публичный и секретный ключи участника \( n_i \).
- Операции с RSA: \( r^c \cdot l \bmod N \), где \( N \) — модуль RSA.
- Формирование параметров: \( \{ r, s(l, SK_k) \} \), где \( s \) — подпись с использованием секретного ключа.

---

# Часть 2. Использование слепой подписи Чаума в протоколе «Электронное голосование»

---

## 2.1 Основные требования к электронному голосованию

- **Право голоса** — только зарегистрированные избиратели могут голосовать.
- **Анонимность** — невозможно связать голос с конкретным избирателем.
- **Проверяемость** — каждый избиратель может проверить, что его голос учтён.
- **Открытость** — результаты голосования доступны для проверки.

---

## 2.2 Схема протокола с использованием слепой подписи

1. Избиратель формирует голос \( v \) (например, число, кодирующее выбор).
2. Избиратель выбирает случайное число \( r \), взаимно простое с \( N \).
3. Вычисляет слепое сообщение:

   $$
   v' = v \cdot r^e \bmod N
   $$

4. Отправляет \( v' \) избирательной комиссии (ИК).
5. ИК подписывает \( v' \) своим секретным ключом:

   $$
   s' = (v')^d \bmod N
   $$

6. Возвращает \( s' \) избирателю.
7. Избиратель «открывает» подпись:

   $$
   s = s' \cdot r^{-1} \bmod N
   $$

8. Отправляет пару \( (v, s) \) в систему голосования.
9. Система проверяет подпись:

   $$
   s^e \stackrel{?}{=} v \pmod{N}
   $$

10. Если проверка успешна, голос засчитывается.

---

## 2.3 Обеспечение анонимности и предотвращение двойного голосования

- Поскольку ИК подписывает слепое сообщение \( v' \), она не знает, какой именно голос подписывает.
- Связь между \( v \) и \( v' \) скрыта случайным числом \( r \).
- Для предотвращения двойного голосования ИК контролирует выдачу подписей на слепые сообщения, выдавая не более одной подписи на избирателя.

---

## 2.4 Иллюстрация из конспекта

- Отрезок длины \( r \), часть которого \( h \) выделена, символизирует выделение части данных или параметров.
- Итоговая формула для результата голосования:

  $$
  b = (r^c \cdot h) \bmod N
  $$

  где \( r, c, h \) — параметры, связанные с голосом и подписью.

---

## 2.5 Пример вычислений (из дополнительного материала)

Пусть:

- \( N = 2537 \), \( e = 13 \), \( d = 937 \),
- голос \( v = 42 \),
- случайное \( r = 7 \).

Вычисляем слепое сообщение:

$$
v' = 42 \times 7^{13} \bmod 2537 = 1361
$$

Подписывающий вычисляет:

$$
s' = (1361)^{937} \bmod 2537
$$

Избиратель находит обратное к \( r = 7 \) по модулю \( 2537 \):

$$
r^{-1} = 725
$$

Открывает подпись:

$$
s = s' \times 725 \bmod 2537
$$

Проверка:

$$
s^{13} \stackrel{?}{=} 42 \pmod{2537}
$$

---

# Часть 3. Протокол «Игра в покер по переписке» (Ментальный покер)

---

## 3.1 Цель протокола

Обеспечить честную игру в покер между удалёнными игроками без доверенного третьего лица, при этом:

- Карты случайно перемешаны и распределены.
- Никто не знает карты других игроков.
- Нельзя подделать или изменить карты.
- Все игроки уверены в честности игры.

---

## 3.2 Основные криптографические задачи

- Совместное шифрование и перемешивание карт.
- Использование ключей RSA для шифрования.
- Обмен вложенными зашифрованными сообщениями.
- Использование цифровых подписей и проверок для подтверждения честности.

---

## 3.3 Модель протокола (из конспекта и дополнительного материала)

- Участники: игроки \( A \) и \( B \).
- У \( A \) есть набор ключей \( \{k_1, k_2, ..., k_n\} \).
- У \( B \) есть ключ \( k_B \).
- Карты представлены сообщениями \( m \).

---

## 3.4 Процесс обмена и шифрования

1. Игрок \( A \) шифрует сообщение \( m \) вложенно:

   $$
   E(k_2, E(k_1, m)) = E(k_1, E(k_2, m))
   $$

   где \( E(k, m) \) — шифрование сообщения \( m \) ключом \( k \).

2. Игрок \( B \) расшифровывает с помощью своего ключа \( k_B \).

3. Обмен вложенными шифрами обеспечивает, что никто не может узнать карты другого.

4. Используются подписи и проверки:

   $$
   \{r, h^{d}\}, \quad \text{sign}_{SK}
   $$

   где \( r, h \) — параметры, \( d \) — секретный ключ, \( \text{sign}_{SK} \) — подпись.

---

## 3.5 Обмен ключами и сообщениям (из конспекта)

- Ключи \( k_1, k_2 \) участников \( A \) и \( B \).
- Сообщение \( m \).
- Все операции по модулю \( N \).
- Связь ключей:

  $$
  k_1 \equiv 1 \mod \text{rev}_{k_1}, \quad k_2 \equiv 1 \mod \text{rev}_{k_2}
  $$

- Итог:

  $$
  k_1 k_2 \equiv (k_1 k_2) m \bmod N
  $$

---

## 3.6 Механизм коммитмента (commitment)

- Участники обмениваются значениями \( f \) и \( g \), а также солью \( \text{salt}_a \), \( \text{salt}_b \).
- Итоговый хеш:

  $$
  H(f \parallel \text{salt}_a \parallel \text{salt}_b \parallel g)
  $$

  где \( H \) — хеш-функция, \( \parallel \) — конкатенация.

- Это обеспечивает честность и невозможность изменения данных после фиксации.

---

## 3.7 Интуиция протокола

- Игрок \( A \) шифрует карты своим ключом и перемешивает.
- Игрок \( B \) шифрует полученные карты своим ключом и перемешивает.
- Игрок \( A \) расшифровывает свои слои шифрования.
- Игрок \( B \) расшифровывает свои слои.
- В итоге каждый игрок знает только свои карты, остальные остаются зашифрованными.

---

# Итоговое резюме

---

| Протокол                     | Цель и особенности                                                                                   | Ключевые операции и формулы                                                                                   |
|------------------------------|----------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------|
| **Слепая подпись Чаума**      | Получение подписи на сообщение без раскрытия его содержимого подписывающему.                       | \( m' = m \cdot r^e \bmod N \), \( s' = (m')^d \bmod N \), \( s = s' \cdot r^{-1} \bmod N \)                   |
| **Электронное голосование**   | Анонимное и проверяемое голосование с использованием слепой подписи.                               | Голос \( v \), слепое сообщение \( v' = v \cdot r^e \bmod N \), подпись \( s' = (v')^d \bmod N \), проверка \( s^e \equiv v \pmod{N} \) |
| **Игра в покер по переписке** | Честная игра без доверенного посредника с помощью совместного шифрования и перемешивания карт.    | Вложенное шифрование: \( E(k_2, E(k_1, m)) = E(k_1, E(k_2, m)) \), обмен ключами и коммитменты для честности.  |

---

# Рекомендуемая литература для углубления

- D. Chaum, "Blind Signatures for Untraceable Payments," Advances in Cryptology — CRYPTO ’82.
- M. Blum, "Mental Poker," Proceedings of the 14th Annual IEEE Symposium on Foundations of Computer Science, 1973.
- A. Menezes, P. van Oorschot, S. Vanstone, "Handbook of Applied Cryptography," CRC Press, 1996.
- J. Katz, Y. Lindell, "Introduction to Modern Cryptography," 2nd Edition, CRC Press, 2014.

---

Если необходима более детальная расшифровка формул, алгоритмов или примеров — готов помочь с разбором!